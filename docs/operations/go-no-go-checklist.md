# BOM êµ¬ì„±í’ˆ ì¶”ê°€ ê¸°ëŠ¥ Go/No-Go ê²Œì´íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

**ë°°í¬ ëŒ€ìƒ:** Phase 2 - BOM êµ¬ì„±í’ˆ ì¶”ê°€  
**ë°°í¬ í™˜ê²½:** Production (139.59.110.55)  
**ì²´í¬ ì¼ì‹œ:** 2025-10-06  
**ë‹´ë‹¹ìž:** [ì´ë¦„]  
**ìµœì¢… ìŠ¹ì¸ìž:** [ì´ë¦„]

---

## ðŸš¦ Go/No-Go ê²°ì • ê¸°ì¤€

- **âœ… GO:** 4ê°œ ë¸”ë¡ ëª¨ë‘ 100% ì²´í¬
- **âš ï¸ CONDITIONAL GO:** 1ê°œ ë¸”ë¡ 80% ì´ìƒ, ë‚˜ë¨¸ì§€ 100%
- **âŒ NO-GO:** 2ê°œ ì´ìƒ ë¸”ë¡ 80% ë¯¸ë§Œ

---

## ðŸ“¦ ë¸”ë¡ A: ê¸°ëŠ¥ / ê¶Œí•œ (í•„ìˆ˜)

### A-1. ë‹¨ì¼ ë²„íŠ¼ ì»´í¬ë„ŒíŠ¸

- [ ] ë¹ˆ BOM ìƒíƒœì—ì„œ "êµ¬ì„±í’ˆ ì¶”ê°€" ë²„íŠ¼ í‘œì‹œ
- [ ] ê¸°ì¡´ BOM ìƒíƒœì—ì„œ "êµ¬ì„±í’ˆ ì¶”ê°€" ë²„íŠ¼ í‘œì‹œ
- [ ] ë‘ ë²„íŠ¼ì´ **ë™ì¼í•œ ì»´í¬ë„ŒíŠ¸**ë¡œ ë Œë”ë§ë¨ (ì½”ë“œ í™•ì¸)
- [ ] ë²„íŠ¼ ìƒíƒœê°€ **ë‹¨ì¼ ë¡œì§**ìœ¼ë¡œ ì œì–´ë¨

**ê²€ì¦ ë°©ë²•:**

```bash
# ì½”ë“œ í™•ì¸
grep -n "AddComponentButton" src/features/items/components/BomTree.tsx
# ê²°ê³¼: ë‘ ê³³ì—ì„œ ë™ì¼ ì»´í¬ë„ŒíŠ¸ í˜¸ì¶œ í™•ì¸
```

**ê²°ê³¼:** [ ] âœ… Pass / [ ] âŒ Fail

---

### A-2. RBAC ê¶Œí•œ ì²´í¬

- [ ] **admin** ê³„ì •: ë²„íŠ¼ í™œì„±í™” í™•ì¸
- [ ] **manager** ê³„ì •: ë²„íŠ¼ í™œì„±í™” í™•ì¸
- [ ] **staff** ê³„ì •: ë²„íŠ¼ í™œì„±í™” í™•ì¸
- [ ] **readonly** ê³„ì •: ë²„íŠ¼ **ë¹„í™œì„±í™”** í™•ì¸
- [ ] readonly ê³„ì •ì—ì„œ ë§ˆìš°ìŠ¤ í˜¸ë²„ ì‹œ íˆ´íŒ í‘œì‹œ: "êµ¬ì„±í’ˆ ì¶”ê°€ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤"

**ê²€ì¦ ë°©ë²•:**

1. http://139.59.110.55 ì ‘ì†
2. ê° ê³„ì •ìœ¼ë¡œ ìˆœì°¨ ë¡œê·¸ì¸
3. ìƒí’ˆ ìƒì„¸ â†’ BOM êµ¬ì¡° íƒ­ ì§„ìž…
4. "êµ¬ì„±í’ˆ ì¶”ê°€" ë²„íŠ¼ ìƒíƒœ í™•ì¸

**ê²°ê³¼:** [ ] âœ… Pass / [ ] âŒ Fail

---

### A-3. ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì²˜ë¦¬

- [ ] "ì¶”ê°€" ë²„íŠ¼ í´ë¦­ ì‹œ **ë¡œë”© ìŠ¤í”¼ë„ˆ** í‘œì‹œ
- [ ] ë¡œë”© ì¤‘ ë²„íŠ¼ **ë¹„í™œì„±í™”** (ì¤‘ë³µ í´ë¦­ ë°©ì§€)
- [ ] ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì‹œ **ì—ëŸ¬ í† ìŠ¤íŠ¸** í‘œì‹œ
- [ ] ì˜¤ë¥˜ í›„ ë²„íŠ¼ **ìž¬í™œì„±í™”** (ìž¬ì‹œë„ ê°€ëŠ¥)
- [ ] ìž¬ì‹œë„ ì‹œ ì •ìƒ ë™ìž‘

**ê²€ì¦ ë°©ë²•:**

1. Chrome DevTools â†’ Network â†’ Offline
2. "êµ¬ì„±í’ˆ ì¶”ê°€" â†’ í•­ëª© ì„ íƒ â†’ "ì¶”ê°€" í´ë¦­
3. ì—ëŸ¬ í™•ì¸ í›„ â†’ Network â†’ No throttling
4. "ì¶”ê°€" ë²„íŠ¼ ë‹¤ì‹œ í´ë¦­ â†’ ì •ìƒ ì¶”ê°€ í™•ì¸

**ê²°ê³¼:** [ ] âœ… Pass / [ ] âŒ Fail

---

### A-4. ì¤‘ë³µ ì¶”ê°€ ì‹œë„

- [ ] ë™ì¼ êµ¬ì„±í’ˆ ìž¬ì¶”ê°€ ì‹œ **ì—ëŸ¬ í† ìŠ¤íŠ¸** í‘œì‹œ
- [ ] ëª¨ë‹¬ **ì—´ë¦° ìƒíƒœ ìœ ì§€** (ë‹«ížˆì§€ ì•ŠìŒ)
- [ ] ë‹¤ë¥¸ êµ¬ì„±í’ˆ ì„ íƒ í›„ **ì •ìƒ ì¶”ê°€ ê°€ëŠ¥**

**ê²€ì¦ ë°©ë²•:**

1. LCD ëª¨ë“ˆ ì¶”ê°€
2. LCD ëª¨ë“ˆ ë‹¤ì‹œ ì¶”ê°€ ì‹œë„
3. ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸
4. ì „ì› ëª¨ë“ˆ ì¶”ê°€ â†’ ì •ìƒ ìž‘ë™ í™•ì¸

**ê²°ê³¼:** [ ] âœ… Pass / [ ] âŒ Fail

---

**ë¸”ë¡ A ì™„ë£Œìœ¨:** \_\_\_/4 (100% í•„ìˆ˜)

---

## ðŸ”’ ë¸”ë¡ B: ë°ì´í„° ë¬´ê²°ì„± (í•„ìˆ˜)

### B-1. ì¤‘ë³µ êµ¬ì„±í’ˆ ë°©ì§€ (DB ë ˆë²¨)

- [ ] Supabase `bom_components` í…Œì´ë¸”ì— `UNIQUE(parent_item_id, component_item_id)` ì œì•½ ì¡´ìž¬
- [ ] ë°±ì—”ë“œ APIì—ì„œ ì¤‘ë³µ ì²´í¬ ë¡œì§ êµ¬í˜„
- [ ] HTTP 409 Conflict ë°˜í™˜ (ë˜ëŠ” ëª…í™•í•œ ì—ëŸ¬ ë©”ì‹œì§€)

**ê²€ì¦ ë°©ë²•:**

```bash
# DB ì œì•½ í™•ì¸ (Supabase Dashboard ë˜ëŠ” SQL)
ssh root@139.59.110.55
# Supabase ì ‘ì† í›„ ì‹¤í–‰
SELECT constraint_name, constraint_type
FROM information_schema.table_constraints
WHERE table_name = 'bom_components' AND constraint_type = 'UNIQUE';
```

**ê²°ê³¼:** [ ] âœ… Pass / [ ] âŒ Fail

---

### B-2. ìˆœí™˜ ì°¸ì¡° ë°©ì§€

#### B-2-1. ì§ì ‘ ìˆœí™˜ (A â†’ A)

- [ ] ìƒí’ˆ Aì— ìžê¸° ìžì‹ (A)ì„ êµ¬ì„±í’ˆìœ¼ë¡œ ì¶”ê°€ ì‹œë„
- [ ] ë°±ì—”ë“œì—ì„œ ê±°ë¶€ (HTTP 409)
- [ ] ì—ëŸ¬ ë©”ì‹œì§€: "ìƒí’ˆì„ ìžê¸° ìžì‹ ì˜ êµ¬ì„±í’ˆìœ¼ë¡œ ì¶”ê°€í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"

**ê²°ê³¼:** [ ] âœ… Pass / [ ] âŒ Fail

#### B-2-2. ê°„ì ‘ ìˆœí™˜ (A â†’ B â†’ C â†’ A)

- [ ] ë°±ì—”ë“œì— ìž¬ê·€ ìˆœí™˜ ì°¸ì¡° ì²´í¬ ë¡œì§ êµ¬í˜„ í™•ì¸
- [ ] í…ŒìŠ¤íŠ¸ ë°ì´í„°: A â†’ B â†’ C (ì •ìƒ)
- [ ] Cì— A ì¶”ê°€ ì‹œë„ â†’ ê±°ë¶€ (HTTP 409)
- [ ] ì—ëŸ¬ ë©”ì‹œì§€: "ìˆœí™˜ ì°¸ì¡°ê°€ ë°œìƒí•©ë‹ˆë‹¤"

**ê²€ì¦ ë°©ë²•:**

```bash
# ë°±ì—”ë“œ ì½”ë“œ í™•ì¸
ssh root@139.59.110.55
grep -A 20 "check_circular_reference" /opt/erp-backend/app/main.py
# í•¨ìˆ˜ ì¡´ìž¬ ì—¬ë¶€ í™•ì¸
```

**ê²°ê³¼:** [ ] âœ… Pass / [ ] âš ï¸ Partial (ì§ì ‘ ìˆœí™˜ë§Œ) / [ ] âŒ Fail

---

### B-3. ìˆ˜ëŸ‰ ìœ íš¨ì„± ê·œì¹™ ì¼ì¹˜

**í”„ë¡ íŠ¸ì—”ë“œ ê·œì¹™:**

- [ ] ìµœì†Œê°’: 0.01 (ë˜ëŠ” 0ë³´ë‹¤ í° ê°’)
- [ ] ìµœëŒ€ê°’: 9999
- [ ] ì†Œìˆ˜ì  ìžë¦¬: ìµœëŒ€ 2ìžë¦¬ (ë˜ëŠ” 4ìžë¦¬)

**ë°±ì—”ë“œ ê·œì¹™:**

- [ ] Pydantic ëª¨ë¸ë¡œ ìˆ˜ëŸ‰ ê²€ì¦ (`quantity: float = Field(gt=0, le=9999)`)
- [ ] DB ì œì•½: `CHECK(quantity > 0 AND quantity <= 9999)`
- [ ] HTTP 422 Unprocessable Entity ë°˜í™˜

**ê²€ì¦ ë°©ë²•:**

1. í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ìˆ˜ëŸ‰ `-1` ìž…ë ¥ ì‹œë„ â†’ ê±°ë¶€ í™•ì¸
2. ìˆ˜ëŸ‰ `10000` ìž…ë ¥ ì‹œë„ â†’ ê±°ë¶€ í™•ì¸
3. ë°±ì—”ë“œ ì½”ë“œ í™•ì¸:

```bash
ssh root@139.59.110.55
grep -A 5 "class BomComponentCreate" /opt/erp-backend/app/main.py
```

**ê²°ê³¼:** [ ] âœ… Pass / [ ] âš ï¸ Partial (í”„ë¡ íŠ¸ë§Œ) / [ ] âŒ Fail

---

**ë¸”ë¡ B ì™„ë£Œìœ¨:** \_\_\_/4 (100% í•„ìˆ˜, B-2-2ëŠ” Phase 2.1 í—ˆìš©)

---

## ðŸš€ ë¸”ë¡ C: ë°°í¬ / ìºì‹œ (í•„ìˆ˜)

### C-1. VITE_BUILD_ID ì£¼ìž…

- [ ] `vite.config.ts`ì— ë¹Œë“œID ì£¼ìž… ë¡œì§ ì¡´ìž¬
- [ ] ë¹Œë“œ ì‹œ í™˜ê²½ë³€ìˆ˜ `VITE_BUILD_ID` ì„¤ì •
- [ ] ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ë¹Œë“œID í™•ì¸ ê°€ëŠ¥

**ê²€ì¦ ë°©ë²•:**

```bash
# vite.config.ts í™•ì¸
grep "VITE_BUILD_ID" vite.config.ts

# ë¹Œë“œ í›„ í™•ì¸
VITE_BUILD_ID=$(date +%s) npm run build
# ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ì‹¤í–‰
console.log(import.meta.env.VITE_BUILD_ID)
```

**ê²°ê³¼:** [ ] âœ… Pass / [ ] âŒ Fail

---

### C-2. Nginx ìºì‹œ ì •ì±…

#### C-2-1. HTML ìºì‹œ (í•­ìƒ ìµœì‹  í™•ì¸)

- [ ] `index.html`ì— `Cache-Control: no-cache, must-revalidate` í—¤ë” ì„¤ì •
- [ ] ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸ (DevTools â†’ Network â†’ index.html â†’ Headers)

**ê²€ì¦ ë°©ë²•:**

```bash
curl -I http://139.59.110.55/ | grep -i cache-control
# ì¶œë ¥: Cache-Control: no-cache, must-revalidate
```

**ê²°ê³¼:** [ ] âœ… Pass / [ ] âŒ Fail

#### C-2-2. ì—ì…‹ ìºì‹œ (ìž¥ê¸° ìºì‹œ)

- [ ] `.js`, `.css` íŒŒì¼ì— `Cache-Control: public, immutable, max-age=31536000` í—¤ë”
- [ ] íŒŒì¼ëª…ì— í•´ì‹œ í¬í•¨ í™•ì¸ (ì˜ˆ: `index-abc123.js`)

**ê²€ì¦ ë°©ë²•:**

```bash
curl -I http://139.59.110.55/assets/index-*.js | grep -i cache-control
# ì¶œë ¥: Cache-Control: public, immutable, max-age=31536000
```

**ê²°ê³¼:** [ ] âœ… Pass / [ ] âŒ Fail

---

### C-3. Nginx ë°°í¬ ê²½ë¡œ ì¼ì¹˜

- [ ] Nginx `root` ê²½ë¡œ: `/var/www/erp-app`
- [ ] ì‹¤ì œ ë°°í¬ íŒŒì¼ ì¡´ìž¬ í™•ì¸
- [ ] `index.html` ì ‘ê·¼ ê°€ëŠ¥ í™•ì¸

**ê²€ì¦ ë°©ë²•:**

```bash
ssh root@139.59.110.55
ls -lh /var/www/erp-app/index.html
# íŒŒì¼ í¬ê¸° ë° ìˆ˜ì • ì‹œê° í™•ì¸

# Nginx ì„¤ì • í™•ì¸
grep "root" /etc/nginx/sites-enabled/erp
```

**ê²°ê³¼:** [ ] âœ… Pass / [ ] âŒ Fail

---

**ë¸”ë¡ C ì™„ë£Œìœ¨:** \_\_\_/3 (100% í•„ìˆ˜)

---

## ðŸ“Š ë¸”ë¡ D: ê´€ì¸¡ / ë¡œê·¸ (ê¶Œìž¥)

### D-1. ë°±ì—”ë“œ ë¡œê¹… (êµ¬ì¡°í™”ëœ ë¡œê·¸)

- [ ] BOM êµ¬ì„±í’ˆ ì¶”ê°€ ì„±ê³µ ì‹œ ë¡œê·¸ ì¶œë ¥
- [ ] ë¡œê·¸ í•„ë“œ: `tenantId`, `parentId`, `childId`, `qty`, `userId`
- [ ] ì‹¤íŒ¨ ì‹œ `reason` í•„ë“œ í¬í•¨ (duplicate, cycle, rbac, network)

**ê²€ì¦ ë°©ë²•:**

```bash
ssh root@139.59.110.55
journalctl -u erp-engine -n 50 | grep "BOM_COMPONENT"
```

**ì˜ˆì‹œ ë¡œê·¸:**

```
BOM_COMPONENT_ADDED: tenant=default, parent=59e04536, child=a1b2c3d4, qty=1, user=admin
BOM_COMPONENT_ADD_ERROR: reason=duplicate, parent=59e04536, child=a1b2c3d4, user=admin
```

**ê²°ê³¼:** [ ] âœ… Pass / [ ] âš ï¸ Partial / [ ] âŒ Fail

---

### D-2. í”„ë¡ íŠ¸ì—”ë“œ ì—ëŸ¬ ì¶”ì  (Sentry íƒœê¹…)

- [ ] Sentry ì´ˆê¸°í™” ì½”ë“œ ì¡´ìž¬
- [ ] BOM ì—ëŸ¬ ì‹œ íƒœê·¸ ì¶”ê°€: `bom_error_type: duplicate|cycle|rbac|network`

**ê²€ì¦ ë°©ë²•:**

```bash
grep -r "Sentry" src/
# Sentry.captureException í˜¸ì¶œ í™•ì¸
```

**ê²°ê³¼:** [ ] âœ… Pass / [ ] âš ï¸ Partial (ë¯¸êµ¬í˜„) / [ ] âŒ Fail

---

### D-3. ì„±ëŠ¥ ì§€í‘œ ìˆ˜ì§‘

- [ ] í‰ê·  ì‘ë‹µ ì‹œê°„ ì¸¡ì • (p50, p95)
- [ ] 30íšŒ ì´ìƒ ìƒ˜í”Œ ìˆ˜ì§‘
- [ ] ëª©í‘œ: p95 < 300ms

**ê²€ì¦ ë°©ë²•:**

```javascript
// ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ 30íšŒ ë°˜ë³µ ì¸¡ì •
const times = []
for (let i = 0; i < 30; i++) {
  const start = performance.now()
  // "ì¶”ê°€" ë²„íŠ¼ í´ë¦­
  const end = performance.now()
  times.push(end - start)
}
times.sort((a, b) => a - b)
console.log('p50:', times[15], 'p95:', times[28])
```

**ê²°ê³¼:** [ ] âœ… Pass (p95 < 300ms) / [ ] âš ï¸ Partial / [ ] âŒ Fail

---

**ë¸”ë¡ D ì™„ë£Œìœ¨:** \_\_\_/3 (80% ì´ìƒ ê¶Œìž¥, í•„ìˆ˜ ì•„ë‹˜)

---

## ðŸ“‹ ìµœì¢… ê²°ì •

### ì²´í¬ë¦¬ìŠ¤íŠ¸ ìš”ì•½

| ë¸”ë¡                 | í•­ëª© ìˆ˜ | ì™„ë£Œ     | ì™„ë£Œìœ¨  | í•„ìˆ˜ ì—¬ë¶€ |
| -------------------- | ------- | -------- | ------- | --------- |
| **A. ê¸°ëŠ¥/ê¶Œí•œ**     | 4       | \_\_\_/4 | \_\_\_% | âœ… í•„ìˆ˜   |
| **B. ë°ì´í„° ë¬´ê²°ì„±** | 4       | \_\_\_/4 | \_\_\_% | âœ… í•„ìˆ˜   |
| **C. ë°°í¬/ìºì‹œ**     | 3       | \_\_\_/3 | \_\_\_% | âœ… í•„ìˆ˜   |
| **D. ê´€ì¸¡/ë¡œê·¸**     | 3       | \_\_\_/3 | \_\_\_% | âš ï¸ ê¶Œìž¥   |

### ê²°ì •

- [ ] **âœ… GO** - ë¸”ë¡ A, B, C ëª¨ë‘ 100% / ë¸”ë¡ D 80% ì´ìƒ
- [ ] **âš ï¸ CONDITIONAL GO** - ë¸”ë¡ D 50% ì´ìƒ, ë‚˜ë¨¸ì§€ 100% (1ì£¼ì¼ ë‚´ ë³´ì™„ ì•½ì†)
- [ ] **âŒ NO-GO** - ë¸”ë¡ A, B, C ì¤‘ í•˜ë‚˜ë¼ë„ 80% ë¯¸ë§Œ

### ìŠ¹ì¸ìž ì„œëª…

**ê²€í† ìž:** ************\_************ (ë‚ ì§œ: **\_\_\_**)  
**ìµœì¢… ìŠ¹ì¸ìž:** ************\_************ (ë‚ ì§œ: **\_\_\_**)

---

### No-Go ì‹œ ì•¡ì…˜ í”Œëžœ

**ë¯¸ì™„ë£Œ í•­ëª©:**

1. [í•­ëª©ëª…] - [ë‹´ë‹¹ìž] - [ì™„ë£Œ ì˜ˆì •ì¼]
2. [í•­ëª©ëª…] - [ë‹´ë‹¹ìž] - [ì™„ë£Œ ì˜ˆì •ì¼]

**ìž¬ê²€í†  ì¼ì‹œ:** ******\_\_\_\_******

---

## ðŸš€ Go í›„ ì¦‰ì‹œ ì‹¤í–‰ í•­ëª© (ë°°í¬ ë‹¹ì¼)

### 1. ë°°í¬ ì „ ë°±ì—…

```bash
# Git íƒœê·¸
git tag v1.2.0-bom-phase2
git push origin v1.2.0-bom-phase2

# ì„œë²„ ë°±ì—…
ssh root@139.59.110.55 << 'EOFSSH'
  mkdir -p /opt/erp-backup/$(date +%Y%m%d-%H%M%S)
  cp -r /opt/erp-backend /opt/erp-backup/$(date +%Y%m%d-%H%M%S)/
  cp -r /var/www/erp-app /opt/erp-backup/$(date +%Y%m%d-%H%M%S)/
EOFSSH
```

### 2. ë°°í¬ ì‹¤í–‰

```bash
# í”„ë¡ íŠ¸ì—”ë“œ
VITE_BUILD_ID=$(date +%s) npm run build
scp -r dist/* root@139.59.110.55:/var/www/erp-app/

# ë°±ì—”ë“œ (ê°œì„ ì•ˆ ì ìš© ì‹œ)
scp /tmp/bom_api_improved.py root@139.59.110.55:/tmp/
ssh root@139.59.110.55 "systemctl restart erp-engine"
```

### 3. ìŠ¤ëª¨í¬ í…ŒìŠ¤íŠ¸ (5ë¶„)

- [ ] http://139.59.110.55 ì ‘ì† â†’ Hard Reload (Cmd+Shift+R)
- [ ] ë¡œê·¸ì¸ â†’ ìƒí’ˆ ìƒì„¸ â†’ BOM êµ¬ì¡° íƒ­
- [ ] êµ¬ì„±í’ˆ 2ê°œ ì—°ì† ì¶”ê°€ â†’ ì„±ê³µ í™•ì¸
- [ ] ì¤‘ë³µ ì¶”ê°€ ì‹œë„ â†’ ì—ëŸ¬ í™•ì¸

### 4. ëª¨ë‹ˆí„°ë§ í™œì„±í™”

```bash
# ë¡œê·¸ ì‹¤ì‹œê°„ í™•ì¸ (ë°°í¬ í›„ 10ë¶„)
ssh root@139.59.110.55
journalctl -u erp-engine -f | grep BOM
```

---

**ë¬¸ì„œ ë²„ì „:** v1.0  
**ìµœì¢… ìˆ˜ì •:** 2025-10-06  
**ë‹´ë‹¹ìž:** Operations Team
