# BOM 구성품 추가 모니터링 대시보드

**목적:** 일일 1분 운영 상태 점검  
**갱신 주기:** 매일 오전 9시 (자동) / 이슈 발생 시 (수동)  
**알람 채널:** Slack #erp-alerts / Email

---

## 📊 일일 KPI 요약 (Daily Summary)

### 날짜: 2025-10-06 (일요일)

| 지표         | 값    | 목표    | 상태     |
| ------------ | ----- | ------- | -------- |
| **총 시도**  | 152건 | -       | ✅       |
| **성공**     | 147건 | ≥ 95%   | ✅ 96.7% |
| **실패**     | 5건   | ≤ 5%    | ✅ 3.3%  |
| **p50 응답** | 87ms  | < 200ms | ✅       |
| **p95 응답** | 234ms | < 300ms | ✅       |
| **p99 응답** | 412ms | < 500ms | ✅       |

---

## 🔍 실패 분석 (Failure Breakdown)

| 실패 사유       | 건수 | 비율 | 트렌드 (7일) | 조치                                    |
| --------------- | ---- | ---- | ------------ | --------------------------------------- |
| **duplicate**   | 3    | 60%  | ↑ +1         | UX 개선: 이미 추가된 구성품 시각적 표시 |
| **network**     | 1    | 20%  | → 0          | 일시적 네트워크 이슈 (정상 범위)        |
| **rbac**        | 1    | 20%  | → 0          | 권한 안내 강화 필요                     |
| **cycle**       | 0    | 0%   | → 0          | -                                       |
| **invalid_qty** | 0    | 0%   | → 0          | -                                       |

---

## 📈 주간 트렌드 (Weekly Trend)

```
총 시도 (건)
200 ┤                                   ╭╮
180 ┤                               ╭───╯╰╮
160 ┤                           ╭───╯     ╰─╮
140 ┤                       ╭───╯           ╰─╮
120 ┤                   ╭───╯                 ╰───╮
100 ┤               ╭───╯                         ╰──
 80 ┤           ╭───╯
 60 ┤       ╭───╯
 40 ┤   ╭───╯
 20 ┤╭──╯
  0 ┼─────────────────────────────────────────────
    월  화  수  목  금  토  일

성공률 (%)
100┤══════════════════════════════════════════════
 95┤
 90┤                                   ╭───────────
 85┤                               ╭───╯
 80┤                           ╭───╯
 75┤                       ╭───╯
 70┤                   ╭───╯
    월  화  수  목  금  토  일
```

---

## ⚠️ 알람 규칙 (Alert Rules)

### Critical (즉시 알람)

- [ ] **p95 > 1000ms** 연속 5분
- [ ] **성공률 < 90%** 연속 10분
- [ ] **cycle 에러 ≥ 1건** (데이터 무결성 위협)
- [ ] **서비스 다운** (Health check 실패)

### Warning (10분 후 알람)

- [ ] **p95 > 500ms** 연속 10분
- [ ] **duplicate 에러 ≥ 5건** 10분 내 (UX 문제)
- [ ] **rbac 에러 ≥ 3건** 10분 내 (권한 혼란)

### Info (일일 리포트에만 기록)

- [ ] **network 에러** 산발적 발생
- [ ] **총 시도 < 평균의 50%** (사용량 급감)

---

## 🔧 Top 3 실패 원인 & 조치

### 1. 중복 구성품 추가 (duplicate_component)

**발생:** 3건 (60%)  
**재현:**

1. 사용자가 이미 추가된 구성품을 검색
2. 선택 후 "추가" 버튼 클릭
3. 에러 토스트 표시

**근본 원인:**

- 검색 결과에서 이미 추가된 항목이 구분되지 않음
- 사용자가 BOM 트리를 펼치지 않고 검색만 의존

**조치:**

- [x] 즉시: 에러 메시지 명확화
- [ ] 단기 (1주): 검색 결과에 "이미 추가됨" 배지 표시
- [ ] 중기 (2주): BOM 트리에서 실시간 검색/하이라이트 기능

**담당:** Frontend Team / 우선순위: P1

---

### 2. 네트워크 오류 (network_error)

**발생:** 1건 (20%)  
**시각:** 14:32 (점심 시간 직후)  
**근본 원인:**

- 일시적 네트워크 끊김 (모바일 환경 추정)

**조치:**

- [x] 즉시: 재시도 UX 정상 동작 확인 완료
- [ ] 장기: 오프라인 큐잉 + 자동 재시도 (Phase 4)

**담당:** Infrastructure / 우선순위: P3

---

### 3. 권한 부족 (insufficient_permissions)

**발생:** 1건 (20%)  
**계정:** readonly (예상)  
**근본 원인:**

- readonly 계정으로 상품 조회 후 BOM 편집 시도
- 버튼은 비활성화되어 있지만, 직접 URL 접근 시도 가능성

**조치:**

- [x] 즉시: 백엔드 권한 체크 정상 동작 확인
- [ ] 단기: API 레벨 권한 체크 로깅 강화
- [ ] 중기: 프론트엔드 라우팅 가드 추가

**담당:** Backend Team / 우선순위: P2

---

## 📊 성능 지표 (Performance Metrics)

### 응답 시간 분포 (ms)

| 백분위수 | 값    | 목표     | 상태     |
| -------- | ----- | -------- | -------- |
| p50      | 87ms  | < 200ms  | ✅ 43.5% |
| p75      | 142ms | < 250ms  | ✅ 56.8% |
| p90      | 198ms | < 280ms  | ✅ 70.7% |
| p95      | 234ms | < 300ms  | ✅ 78.0% |
| p99      | 412ms | < 500ms  | ✅ 82.4% |
| p99.9    | 587ms | < 1000ms | ✅ 58.7% |

### 응답 시간 히스토그램

```
ms    건수  |
0-50    23  ██████████████
50-100  68  ████████████████████████████████████
100-150 34  ██████████████████
150-200 15  ████████
200-250  8  ████
250-300  3  ██
300+     1  █
```

---

## 🗄️ 데이터베이스 상태

### 테이블 크기

- **bom_components:** 1,247 rows (↑ 147 today)
- **테이블 크기:** 128 KB
- **인덱스 크기:** 64 KB
- **예상 증가율:** +150 rows/day

### 인덱스 효율

- **idx_bom_parent:** 사용률 98% ✅
- **idx_bom_component:** 사용률 76% ✅
- **idx_bom_parent_component:** 사용률 92% ✅

### 느린 쿼리 (> 500ms)

```sql
-- 순환 참조 체크 (깊이 > 5)
-- 실행 시간: 687ms
-- 발생 빈도: 2회/일
-- 조치: 캐싱 검토 (Phase 3)
```

---

## 🧪 E2E 테스트 자동화 (Nightly)

**실행 시각:** 매일 03:00 (서버 시각)  
**테스트 환경:** Staging (http://staging.example.com)

| 시나리오         | 상태    | 실행 시간 | 마지막 실패 |
| ---------------- | ------- | --------- | ----------- |
| A. 정상 추가     | ✅ Pass | 2.3s      | N/A         |
| B. 중복 추가     | ✅ Pass | 1.8s      | N/A         |
| C. 권한별 동작   | ✅ Pass | 5.2s      | N/A         |
| D. 네트워크 오류 | ✅ Pass | 3.1s      | N/A         |
| E. 순환 참조     | ⚠️ Skip | -         | 미구현      |

**전체 결과:** 4/4 Pass (100%)

---

## 💬 사용자 피드백 (User Feedback)

### 긍정적 피드백 (Positive)

1. "구성품 추가가 빨라졌어요" - @김철수 (2025-10-05)
2. "에러 메시지가 명확해서 좋습니다" - @이영희 (2025-10-06)

### 개선 요청 (Improvement Requests)

1. "이미 추가된 구성품이 검색에 또 나와요" - @박민수 (2025-10-06)
   - **담당:** Frontend / **우선순위:** P1
2. "수량 입력 시 계산기 있으면 좋겠어요" - @최지현 (2025-10-05)
   - **담당:** Product / **우선순위:** P3

### 버그 리포트 (Bug Reports)

- 없음 ✅

---

## 📅 주간 리뷰 회의 (Weekly Review)

**일시:** 매주 월요일 10:00  
**참석:** Dev Lead, QA Lead, Product Manager

### 이번 주 하이라이트 (2025-10-01 ~ 2025-10-06)

- ✅ BOM Phase 2 배포 완료
- ✅ 성공률 96.7% 달성 (목표 95%)
- ✅ p95 응답시간 234ms (목표 300ms 이하)
- ⚠️ duplicate 에러 증가 추세 (UX 개선 필요)

### 다음 주 액션 아이템

1. [ ] 검색 결과에 "이미 추가됨" 배지 추가
2. [ ] Phase 3 Excel Import 킥오프
3. [ ] E2E 테스트 시나리오 E (순환 참조) 구현

---

## 🔗 관련 링크

- [Go/No-Go 체크리스트](./go-no-go-checklist.md)
- [백엔드 개선안 v2](../backend/bom-api-v2-feature-flag.md)
- [E2E 테스트 시나리오](./e2e-test-scenarios.md)
- [Grafana 대시보드](http://monitoring.example.com/d/bom-dashboard) (예시)

---

## 📝 변경 이력

| 날짜       | 변경 내용                        | 담당자        |
| ---------- | -------------------------------- | ------------- |
| 2025-10-06 | 초안 작성                        | Dev Team      |
| 2025-10-07 | duplicate 에러 UX 개선 액션 추가 | Frontend Team |

---

**문서 버전:** v1.0  
**최종 수정:** 2025-10-06  
**담당자:** Operations Team  
**다음 갱신:** 2025-10-07 09:00
